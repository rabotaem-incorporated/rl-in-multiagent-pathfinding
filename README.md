## Репозиторий проекта "RL в многоагентном планировании". 

В рамках этого проекта был написан код для инференса моделей DCC и SCRIMP как на пользовательских так и на автоматически генерируемых задачах MAPF, визуализации полученных решений и вычисления статистик для сравнения двух моделей.

# Установка

Склонировать репозиторий. Используя Python==3.12, выполнить `pip install -r requirements.txt`


# Генерация тестов

`tests/generate.py` предоставляет интерфейс для удобной генерации тестов функции 

* `create_single_test` и `create_multiple_tests` генерируют задачи с заданными размером карты, количеством агентов и плотностью препятствий и сохраняют их в файл в формате `pickle.dump([(карта, начальные позиции агентов, конечные позиции агентов), ...])`

* `create_test_from_map` генерирует задачу с заданной картой и начальными и конечными позициами агентов

* Сгенерированные тесты хранятся в `tests/test_set`.

# DCC

`tests/test_dcc.py` предоставляет интерфейс для запуска инференса DCC, сохранения и визуализации полученных результатов

* `run_tests_from_file` принимает на вход путь к файлу с тестами и возвращает результаты DCC и анимацию по пути `tests/animatins/{test_name}/animation.svg` в случае, если тест единственный

# SCRIMP

Чтобы установить все зависимости: `pip install -r requirements.txt`

Чтобы сконвертировать веса оригинального SCRIMP в наш формат: `pytohon scrimp/weight_convert.py path_to_original_ckpt path_to_save_ckpt`

Пример использования SCRIMP находится в `scrimp/main.py`

`scrimp/test.py` предоставляет интерфейс аналогичный tests/test_dcc.py для инференса SCRIMP

# Результаты

Так как файлы с результатами довольно большие, прикреплены только несколько таковых, в архиве.

# Визуализация

`visualizer2/app.py` представляет собой приложение для генерации видео с решениями MAPF задач. Использование: `python visualizer2/app.py video --map ... --results ... --run-id N`. Подробнее в `python visualizer2/app.py video --help`

Также приложение можно использвать для интерактивной визуализации. Использование: `python visualizer2/app.py run --map ... --results ... --run-id N`. Подробнее в `python visualizer2/app.py run --help`
